# ==============================================
# ã€å­˜è´§å‘¨è½¬å¤©æ•°ç²¾ç»†åŒ–è®¡ç®—å™¨ã€‘v1.0
# ç‹¬ç‰¹æ€§ï¼šä¾›åº”é“¾å¥åº·åº¦è¯„åˆ† + éšæ€§æˆæœ¬æç¤º + ç»†åˆ†è¡Œä¸šå¯¹æ ‡
# å¼€å‘è€…ï¼šKiwi_hazel
# å…¬å¼ï¼šå­˜è´§å‘¨è½¬ç‡=è¥ä¸šæˆæœ¬/å¹³å‡å­˜è´§ï¼›å‘¨è½¬å¤©æ•°=365/å‘¨è½¬ç‡
# ==============================================

def calculate_inventory_health(cogs, avg_inventory, industry_subtype):
    """
    æ ¸å¿ƒåŠŸèƒ½ï¼šè®¡ç®—å­˜è´§å‘¨è½¬æ•ˆç‡å¹¶è¯„ä¼°ä¾›åº”é“¾å¥åº·åº¦
    :param industry_subtype: ç»†åˆ†è¡Œä¸šï¼ˆå¿«æ¶ˆå“/è€ç”¨å“/å¥¢ä¾ˆå“/åˆ¶é€ ä¸šï¼‰
    """
    if cogs <= 0 or avg_inventory <= 0:
        return {"error": "âš ï¸ æ•°æ®é”™è¯¯ï¼šè¥ä¸šæˆæœ¬å’Œå¹³å‡å­˜è´§éœ€>0ï¼ˆä¾‹ï¼šè¥ä¸šæˆæœ¬=1000ä¸‡ï¼Œå­˜è´§=200ä¸‡ï¼‰"}
    
    # åŸºç¡€è®¡ç®—
    turnover_rate = round(cogs / avg_inventory, 2)  # å‘¨è½¬ç‡ï¼ˆæ¬¡/å¹´ï¼‰
    turnover_days = round(365 / turnover_rate, 1)   # å‘¨è½¬å¤©æ•°ï¼ˆå¤©/æ¬¡ï¼‰
    
    # ç‚¹1ï¼šç»†åˆ†è¡Œä¸šæ ‡å‡†
    industry_standards = {
        "å¿«æ¶ˆå“": {"ä¼˜ç§€": 30, "è‰¯å¥½": 45, "è­¦æˆ’": 60},  # å¦‚é£Ÿå“é¥®æ–™
        "è€ç”¨å“": {"ä¼˜ç§€": 60, "è‰¯å¥½": 90, "è­¦æˆ’": 120},  # å¦‚å®¶ç”µ
        "å¥¢ä¾ˆå“": {"ä¼˜ç§€": 90, "è‰¯å¥½": 150, "è­¦æˆ’": 200}, # å¦‚é«˜ç«¯æœè£…
        "åˆ¶é€ ä¸š": {"ä¼˜ç§€": 60, "è‰¯å¥½": 90, "è­¦æˆ’": 150}   # å¦‚æ±½è½¦é›¶éƒ¨ä»¶
    }
    std = industry_standards.get(industry_subtype, industry_standards["åˆ¶é€ ä¸š"])
    
    # ç‚¹2ï¼šä¾›åº”é“¾å¥åº·åº¦è¯„åˆ†ï¼ˆA/B/C/Dï¼‰
    if turnover_days <= std["ä¼˜ç§€"]:
        health_score = "Aï¼ˆä¼˜ç§€ï¼‰"
        health_note = "ä¾›åº”é“¾é«˜æ•ˆï¼Œå­˜è´§å˜ç°å¿«ï¼Œèµ„é‡‘å ç”¨å°‘"
    elif turnover_days <= std["è‰¯å¥½"]:
        health_score = "Bï¼ˆè‰¯å¥½ï¼‰"
        health_note = "å‘¨è½¬æ­£å¸¸ï¼Œå¯ä¼˜åŒ–é‡‡è´­è®¡åˆ’é™ä½å­˜è´§æ°´å¹³"
    elif turnover_days <= std["è­¦æˆ’"]:
        health_score = "Cï¼ˆè­¦æˆ’ï¼‰"
        health_note = "å‘¨è½¬åæ…¢ï¼Œå¯èƒ½å­˜åœ¨æ»é”€é£é™©ï¼Œå»ºè®®ä¿ƒé”€æ¸…åº“å­˜"
    else:
        health_score = "Dï¼ˆå±é™©ï¼‰"
        health_note = "ä¸¥é‡ç§¯å‹ï¼éœ€ç´§æ€¥åˆ†æå­˜è´§ç»“æ„ï¼Œå¤„ç†å‘†æ»åº“å­˜"
    
    # ç‚¹3ï¼šéšæ€§æˆæœ¬æç¤ºï¼ˆèµ„é‡‘å ç”¨æˆæœ¬ï¼‰
    hidden_cost = round(avg_inventory * 0.05 * (turnover_days / std["è‰¯å¥½"] - 1), 2)
    hidden_note = f"éšæ€§æˆæœ¬ï¼šè¾ƒè‰¯å¥½æ°´å¹³å¤šå ç”¨èµ„é‡‘æˆæœ¬çº¦{hidden_cost}ä¸‡å…ƒï¼ˆæŒ‰å¹´åˆ©ç‡5%ä¼°ç®—ï¼‰" if hidden_cost > 0 else "æ— é¢å¤–éšæ€§æˆæœ¬"
    
    return {
        "turnover_rate": turnover_rate,
        "turnover_days": turnover_days,
        "industry_subtype": industry_subtype,
        "health_score": health_score,
        "health_note": health_note,
        "hidden_cost_note": hidden_note
    }

# ----------------------
# æç®€äº¤äº’ï¼ˆ3æ­¥è¾“å…¥+å¡ç‰‡è¾“å‡ºï¼‰
# ----------------------
if __name__ == "__main__":
    print("\n===== ğŸ“¦ å­˜è´§å‘¨è½¬å¤©æ•°ç²¾ç»†åŒ–è®¡ç®—å™¨ =====")
    print("â†’ ç‹¬ç‰¹åŠŸèƒ½ï¼šä¾›åº”é“¾å¥åº·åº¦è¯„åˆ† + éšæ€§æˆæœ¬æç¤º\n")
    
    # è¾“å…¥ï¼ˆå¸¦ç»†åˆ†è¡Œä¸šç¤ºä¾‹ï¼‰
    cogs = float(input("1. è¥ä¸šæˆæœ¬ï¼ˆä¸‡å…ƒï¼Œä¾‹ï¼šå¿«æ¶ˆå“=8000 â†’ å­˜è´§æˆæœ¬ï¼‰ï¼š"))
    avg_inventory = float(input("2. å¹³å‡å­˜è´§ï¼ˆä¸‡å…ƒï¼Œä¾‹ï¼šå¿«æ¶ˆå“=1000 â†’ æœŸåˆ+æœŸæœ«å­˜è´§/2ï¼‰ï¼š"))
    print("\n3. ç»†åˆ†è¡Œä¸šï¼ˆè¾“å…¥æ•°å­—1-4ï¼‰ï¼š")
    industry_subtype = input("   1.å¿«æ¶ˆå“ 2.è€ç”¨å“ 3.å¥¢ä¾ˆå“ 4.åˆ¶é€ ä¸š â†’ ")
    subtype_map = {"1": "å¿«æ¶ˆå“", "2": "è€ç”¨å“", "3": "å¥¢ä¾ˆå“", "4": "åˆ¶é€ ä¸š"}
    subtype_name = subtype_map.get(industry_subtype, "åˆ¶é€ ä¸š")
    
    # è®¡ç®—+è¾“å‡º
    result = calculate_inventory_health(cogs, avg_inventory, subtype_name)
    print(f"\n{'='*50}")
    if "error" in result:
        print(result["error"])
    else:
        print(f"å­˜è´§å‘¨è½¬ç‡ï¼š{result['turnover_rate']}æ¬¡/å¹´ï¼ˆè¶Šé«˜è¶Šå¥½ï¼‰")
        print(f"å­˜è´§å‘¨è½¬å¤©æ•°ï¼š{result['turnover_days']}å¤©/æ¬¡ï¼ˆè¶ŠçŸ­è¶Šå¥½ï¼‰")
        print(f"ç»†åˆ†è¡Œä¸šï¼š{result['industry_subtype']}ï¼ˆä¼˜ç§€æ ‡å‡†ï¼š<{industry_standards[subtype_name]['ä¼˜ç§€']}å¤©ï¼‰\n")
        print(f"ğŸ¥ ä¾›åº”é“¾å¥åº·åº¦ï¼š{result['health_score']}")
        print(f"ğŸ“ æ”¹å–„å»ºè®®ï¼š{result['health_note']}")
        print(f"ğŸ’° {result['hidden_cost_note']}")
    print(f"\nğŸ’¡ å…³é”®é€»è¾‘ï¼šå‘¨è½¬å¤©æ•°=365/å‘¨è½¬ç‡ â†’ çŸ­å¤©æ•°=å¿«å˜ç°=å°‘èµ„é‡‘å ç”¨")
    print("="*50)
Â 
